<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<title>Paired • Marketplace</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<script src="https://unpkg.com/lucide@latest"></script>
	<link rel="stylesheet" href="styles.css" />
	<script src="theme.js"></script>
	<style>
		.orb { position:absolute; border-radius:50%; filter:blur(80px); opacity:.6; animation:float 20s infinite ease-in-out; }
		.orb1 { width:300px; height:300px; background:orange; top:5%; left:5%; animation-duration:25s; }
		.orb2 { width:250px; height:250px; background:purple; bottom:8%; right:5%; animation-duration:22s; }
		.orb3 { width:220px; height:220px; background:teal; top:35%; left:50%; animation-duration:28s; }
		@keyframes float { 0%,100% { transform:translateY(0) translateX(0);} 50% { transform:translateY(-30px) translateX(30px);} }
		.no-scrollbar { scrollbar-width:none; -ms-overflow-style:none; }
		.no-scrollbar::-webkit-scrollbar { display:none; }
		.line-clamp-2 { display:-webkit-box; -webkit-line-clamp:2; line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
		.filter-btn.active { background:#f97316 !important; color:#fff !important; }
        .featured-card { border-image: linear-gradient(to top right, #f97316, #d946ef) 1; }
		.scroll-hint{position:absolute;top:50%;right:6px;transform:translateY(-50%);background:#fff;color:#000;width:30px;height:30px;border-radius:9999px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 10px -2px rgba(0,0,0,.4);pointer-events:none;font-size:14px;font-weight:600;opacity:.95;transition:opacity .35s,transform .35s;}
		.scroll-hint.fade{opacity:0;transform:translateY(-50%) scale(.8);} 
	</style>
</head>
<body class="bg-black text-white min-h-screen overflow-y-auto overflow-x-hidden relative flex justify-center">

	<!-- Orbs Background -->
	<div class="absolute inset-0 -z-10 pointer-events-none">
		<div class="orb orb1"></div>
		<div class="orb orb2"></div>
		<div class="orb orb3"></div>
	</div>

	<div class="w-full max-w-sm relative z-10">
		<script>window.PAGE_ACTIVE='market';</script>
		<script src="shared-ui.js"></script>
		<!-- Marketplace Content -->
		<main class="px-4 pb-14 space-y-6" data-adjust-offset>
			<!-- Search + Actions Bar (filters removed, Sell & Dashboard added) -->
			<div class="bg-white/5 border border-white/10 backdrop-blur rounded-xl p-3 space-y-3">
				<div class="flex gap-2">
					<input type="text" id="market-search" placeholder="Search Marketplace" class="flex-1 bg-black/30 border border-white/10 rounded-lg px-3 py-2 text-sm placeholder-gray-400 focus:outline-none focus:border-orange-500" />
					<button class="px-3 rounded-lg bg-orange-600 hover:bg-orange-500 text-sm font-medium">Search</button>
				</div>
				<div class="flex gap-2 pt-1 text-sm font-medium">
					<button id="openSell" class="flex-1 relative overflow-hidden rounded-lg bg-gradient-to-br from-orange-600 to-pink-600 hover:from-orange-500 hover:to-pink-500 py-2 flex items-center justify-center gap-2 text-white font-semibold">
						<i data-lucide="plus" class="w-4 h-4"></i><span>Post product</span>
					</button>
					<a href="dashboard.html" class="flex-1 rounded-lg bg-white/10 hover:bg-white/20 py-2 flex items-center justify-center gap-2 border border-white/10">
						<i data-lucide="layout-grid" class="w-4 h-4"></i><span>Dashboard</span>
					</a>
				</div>
			</div>

			<!-- NEW: Featured Items Section -->
			<section class="space-y-3">
                <h2 class="text-sm font-semibold flex items-center gap-2"><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-500"></i>Featured Items</h2>
				<div class="relative">
				<div class="overflow-x-auto no-scrollbar -mx-1 px-1 scroll-featured" style="-webkit-overflow-scrolling:touch;">
					<div class="flex space-x-3 w-max">
                        <!-- Featured Item Card -->
                        <div class="product w-40 flex-shrink-0 bg-white/5 rounded-lg border-2 border-transparent featured-card overflow-hidden cursor-pointer" data-id="11">
                            <div class="h-28 w-full bg-center bg-cover" style="background-image:url('https://picsum.photos/id/180/400/400')"></div>
                            <div class="p-2">
                                <p class="text-[11px] font-semibold leading-tight line-clamp-2">MacBook Air M1 8GB/256GB</p>
                                <p class="text-orange-400 text-[12px] font-bold mt-1">GH₵780</p>
                            </div>
                        </div>
                        <div class="product w-40 flex-shrink-0 bg-white/5 rounded-lg border-2 border-transparent featured-card overflow-hidden cursor-pointer" data-id="8">
                            <div class="h-28 w-full bg-center bg-cover" style="background-image:url('https://picsum.photos/id/1047/400/400')"></div>
                            <div class="p-2">
                                <p class="text-[11px] font-semibold leading-tight line-clamp-2">Gaming Laptop 16GB RAM RTX</p>
                                <p class="text-orange-400 text-[12px] font-bold mt-1">GH₵990</p>
                            </div>
                        </div>
                        <div class="product w-40 flex-shrink-0 bg-white/5 rounded-lg border-2 border-transparent featured-card overflow-hidden cursor-pointer" data-id="3">
                            <div class="h-28 w-full bg-center bg-cover" style="background-image:url('https://picsum.photos/id/1074/400/400')"></div>
                            <div class="p-2">
                                <p class="text-[11px] font-semibold leading-tight line-clamp-2">Used Toyota Corolla 2015 Clean</p>
                                <p class="text-orange-400 text-[12px] font-bold mt-1">GH₵5500</p>
                            </div>
                        </div>
                    </div>
				</div>
				<div id="featuredScrollHint" class="scroll-hint"><i data-lucide="arrow-right" class="w-4 h-4"></i></div>
				</div>
            </section>

			<!-- Today's Picks / Products Grid -->
			<section class="space-y-3" id="product-section">
				<div class="flex items-center justify-between">
					<h2 class="text-sm font-semibold">Today's Picks</h2>
					<button id="refresh-products" class="text-[11px] text-orange-400 hover:underline">Refresh</button>
				</div>
				<div id="products-grid" class="grid grid-cols-2 gap-3">
					<!-- Product Cards injected here -->
				</div>
				<div class="pt-2">
					<button id="load-more" class="w-full py-2 rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 text-sm font-medium">Load more</button>
				</div>
			</section>
		</main>
	</div>

		<!-- Floating Sell Button removed; Sell now in actions bar -->
	<script>
		window.addEventListener('DOMContentLoaded',()=>{ if(window.lucide) lucide.createIcons(); });
		lucide.createIcons();

		const sampleProducts = [
            {id:11, title:'MacBook Air M1 8GB/256GB', price:780, location:'Accra', time:'5d', img:'https://picsum.photos/id/180/400/400', cat:'Electronics', promoted: true, seller: 'Kwame B.', rating: 4.8},
			{id:1, title:'iPhone 13 Pro Max - 256GB Factory Unlocked', price:720, location:'Accra', time:'2h', img:'https://picsum.photos/id/1015/400/400', cat:'Electronics', promoted: false, seller: 'Ama Kusi', rating: 4.9},
			{id:2, title:'Minimal Wood Study Desk', price:140, location:'Cape Coast', time:'3h', img:'https://picsum.photos/id/1062/400/400', cat:'Furniture', promoted: false, seller: 'Esi Nyarko', rating: 4.5},
            {id:8, title:'Gaming Laptop 16GB RAM RTX', price:990, location:'Koforidua', time:'3d', img:'https://picsum.photos/id/1047/400/400', cat:'Electronics', promoted: true, seller: 'Yaw Ofori', rating: 5.0},
			{id:4, title:'Wireless Noise Cancelling Headphones', price:85, location:'Kumasi', time:'1d', img:'https://picsum.photos/id/1080/400/400', cat:'Electronics', promoted: false, seller: 'Ama Kusi', rating: 4.9},
			{id:6, title:'Classic Literature Book Set (10pcs)', price:50, location:'Cape Coast', time:'2d', img:'https://picsum.photos/id/1050/400/400', cat:'Books', promoted: false, seller: 'Aisha M.', rating: 4.7},
		];

		function productCard(p){
			return `<div class="product relative group bg-white/5 border border-white/10 rounded-lg overflow-hidden cursor-pointer" data-id="${p.id}">
                ${p.promoted ? `<div class="absolute top-1 left-1 z-10 text-[9px] font-semibold bg-purple-600 text-white px-1.5 py-0.5 rounded">PROMOTED</div>` : ''}
				<button class="absolute top-1 right-1 z-10 favourite w-8 h-8 flex items-center justify-center rounded-full bg-black/50 backdrop-blur text-white/70 hover:text-orange-400"><i data-lucide="heart" class="w-4 h-4"></i></button>
				<div class="w-full h-36 bg-center bg-cover" style="background-image:url('${p.img}')"></div>
				<div class="p-2 space-y-1">
					<p class="text-[12px] font-semibold leading-tight line-clamp-2">${p.title}</p>
					<p class="text-orange-400 text-[13px] font-bold">GH₵${p.price.toLocaleString()}</p>
					<p class="text-[10px] text-gray-400 flex items-center justify-between"><span>${p.location}</span><span>${p.time}</span></p>
				</div>
			</div>`;
        }
        
        // --- Rendering and interaction logic ---
		let shown = 0; const batch = 6; // filters removed
		const grid = document.getElementById('products-grid');
		function render(reset=false){
			if(reset){ grid.innerHTML=''; shown=0; }
			const list = sampleProducts
				.sort((a,b)=> (b.promoted?1:0) - (a.promoted?1:0)); // promoted first (no category filter)
			const slice = list.slice(0, shown + batch);
			grid.innerHTML = slice.map(productCard).join('');
			shown = slice.length;
			document.getElementById('load-more').classList.toggle('hidden', shown>=list.length);
			lucide.createIcons();
		}
        document.getElementById('load-more').addEventListener('click', ()=> render());
		document.getElementById('refresh-products').addEventListener('click', ()=> { shown=0; render(true); });
		document.addEventListener('click', e=>{
			const fav = e.target.closest('.favourite'); if(fav){ fav.classList.toggle('text-orange-400'); fav.classList.toggle('scale-110'); }
			const productCardEl = e.target.closest('.product'); if(productCardEl){ window.location.href = 'Store.html'; }
		});
		render(true);

		// Scroll hint logic for featured horizontal list
		(function(){
			const scroller = document.querySelector('.scroll-featured');
			const hint = document.getElementById('featuredScrollHint');
			function evalHint(){
				if(!scroller) return; const atEnd = scroller.scrollLeft + scroller.clientWidth >= scroller.scrollWidth - 10; if(atEnd || scroller.scrollWidth<=scroller.clientWidth){ hint.classList.add('fade'); }
				else { hint.classList.remove('fade'); }
			}
			if(scroller){ scroller.addEventListener('scroll', evalHint, {passive:true}); setTimeout(evalHint, 600); }
		})();
	</script>
	<script>
/* Coin + Sell gate logic (simple placeholder) */
(function(){
	const STORAGE_KEY='paired.settings';
	function read(){ try{return JSON.parse(localStorage.getItem(STORAGE_KEY)||'{}');}catch(e){return {};} }
	function write(d){ localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); }
	function getCoins(){ return read().coins||0; }
	function setCoins(n){ const d=read(); d.coins=n; write(d); document.dispatchEvent(new CustomEvent('coins-change',{detail:n})); }
	// Initialize default coins for demo if none
	if(getCoins()===0){ setCoins(25); }
	const badge=document.getElementById('coinBadge');
	function refreshBadge(){ if(badge) badge.textContent = getCoins()+ 'C'; }
	refreshBadge();
	document.addEventListener('coins-change', refreshBadge);
	const openBtn=document.getElementById('openSell');
	if(openBtn){
		openBtn.addEventListener('click', ()=>{
			const coins=getCoins();
			if(coins < 20){ alert('You need at least 20 coins to list a product. You have '+coins+' coins.'); return; }
			// Placeholder: optionally deduct coins here -> setCoins(coins-20);
			// Let existing sell modal logic open
			const ev=new Event('click'); document.getElementById('openSell').removeEventListener('click',()=>{}); // no-op safeguard
			// Directly open modal by calling the existing function (trigger original listener) - fallback manual open
			const sellModal=document.getElementById('sellModal');
			if(sellModal){ sellModal.classList.remove('hidden'); document.body.classList.add('no-scroll'); if(window.lucide) lucide.createIcons(); }
		}, {once:false});
	}
})();
</script>
	
	<!-- Sell Modal -->
	<div id="sellModal" class="fixed inset-0 z-[1000] hidden"><div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div><div class="absolute inset-x-0 top-0 mx-auto w-full max-w-sm p-4 animate-fade-in"><div class="bg-white/10 border border-white/20 rounded-2xl shadow-xl overflow-hidden flex flex-col max-h-[90vh]"><div class="flex items-center justify-between px-4 py-3 border-b border-white/10"><h3 class="text-sm font-semibold">List an Item</h3><button id="closeSell" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10"><i data-lucide="x" class="w-5 h-5"></i></button></div>
	<form id="sellForm" class="p-4 space-y-4 overflow-y-auto">
		<div><label class="text-xs font-medium block mb-1">Product Images (max 4)</label><input id="sellImages" type="file" accept="image/*" multiple class="block w-full text-xs" /><div id="sellPreview" class="mt-2 grid grid-cols-2 gap-2"></div></div>
		<div><label class="text-xs font-medium block mb-1">Title</label><input required id="sellTitle" type="text" class="w-full px-3 py-2 rounded-lg bg-black/30 border border-white/10 text-sm focus:outline-none" placeholder="e.g. iPhone 13 Pro Max" /></div>
		<div class="flex gap-2"><div class="flex-1"><label class="text-xs font-medium block mb-1">Price (GH₵)</label><input required id="sellPrice" type="number" min="0" class="w-full px-3 py-2 rounded-lg bg-black/30 border border-white/10 text-sm focus:outline-none" /></div><div class="w-28"><label class="text-xs font-medium block mb-1">Category</label><select id="sellCategory" class="w-full px-2 py-2 rounded-lg bg-black/30 border border-white/10 text-xs focus:outline-none"><option>Electronics</option><option>Fashion</option><option>Furniture</option><option>Books</option></select></div></div>
		<div><label class="text-xs font-medium block mb-1">Description</label><textarea id="sellDesc" rows="3" class="w-full px-3 py-2 rounded-lg bg-black/30 border border-white/10 text-sm focus:outline-none resize-none" placeholder="Condition, features, etc."></textarea></div>
        <!-- NEW: Boost Listing Option -->
        <div class="bg-white/5 border border-white/10 rounded-lg p-3">
            <label class="flex items-center gap-3 text-sm select-none cursor-pointer">
                <input id="sellBoost" type="checkbox" class="accent-orange-600 w-4 h-4">
                <span class="flex items-center gap-2 font-semibold">
                    <i data-lucide="zap" class="w-4 h-4 text-yellow-400"></i>
                    Boost this listing
                </span>
            </label>
            <p class="text-xs text-gray-400 mt-1 pl-7">Get up to 5x more views by featuring your item. Fees apply.</p>
        </div>
		<button id="sellSubmit" type="submit" class="w-full py-2 rounded-lg bg-orange-600 hover:bg-orange-500 font-medium text-sm">Publish</button>
	</form></div></div></div>

    <!-- NEW: Boost Modal -->
    <div id="boostModal" class="fixed inset-0 z-[1200] hidden"><div class="absolute inset-0 bg-black/80 backdrop-blur-md"></div><div class="absolute inset-x-0 top-0 mx-auto w-full max-w-sm p-4 animate-fade-in"><div class="bg-gradient-to-br from-orange-600/20 to-purple-600/20 border border-white/20 rounded-2xl shadow-xl p-5 text-center space-y-4">
        <div class="w-16 h-16 mx-auto rounded-full bg-gradient-to-br from-orange-500 to-purple-600 flex items-center justify-center"><i data-lucide="zap" class="w-8 h-8 text-white"></i></div>
        <h3 class="text-lg font-bold">Boost Your Listing!</h3>
        <p class="text-sm text-gray-300">Reach more buyers and sell faster by featuring your item at the top of the marketplace.</p>
        <div class="bg-white/10 rounded-lg p-3 space-y-2 text-left">
            <div class="flex items-center gap-2"><i data-lucide="check-circle-2" class="w-4 h-4 text-green-400"></i><span class="text-xs">Top placement for 24 hours</span></div>
            <div class="flex items-center gap-2"><i data-lucide="check-circle-2" class="w-4 h-4 text-green-400"></i><span class="text-xs">Featured badge on your listing</span></div>
            <div class="flex items-center gap-2"><i data-lucide="check-circle-2" class="w-4 h-4 text-green-400"></i><span class="text-xs">Up to 5x more views</span></div>
        </div>
        <div class="flex gap-2 pt-2">
            <button id="cancelBoost" class="flex-1 py-2 rounded-full bg-white/10 hover:bg-white/20 text-sm font-medium">Maybe Later</button>
            <button id="confirmBoost" class="flex-1 py-2 rounded-full bg-orange-600 hover:bg-orange-500 text-sm font-medium">Pay GH₵5.00</button>
        </div>
    </div></div></div>

	<!-- Product Detail Modal -->
	<div id="productModal" class="fixed inset-0 z-[1100] hidden"><div class="absolute inset-0 bg-black/70 backdrop-blur-md"></div><div class="absolute inset-x-0 top-0 mx-auto w-full max-w-sm p-4 animate-fade-in"><div class="bg-white/10 border border-white/20 rounded-2xl shadow-xl overflow-hidden flex flex-col"><div class="relative w-full h-64 bg-center bg-cover" id="pmImage"></div><button id="closeProduct" class="absolute top-2 right-2 w-9 h-9 flex items-center justify-center rounded-full bg-black/40 hover:bg-black/60 backdrop-blur border border-white/10"><i data-lucide="x" class="w-5 h-5"></i></button>
	<div class="p-4 space-y-3">
		<h3 id="pmTitle" class="text-sm font-semibold leading-snug"></h3>
		<p id="pmPrice" class="text-orange-400 font-bold"></p>
        <!-- NEW: Seller Info -->
        <div id="pmSeller" class="text-xs text-gray-300 flex items-center gap-2"></div>
		<p id="pmDesc" class="text-[12px] text-gray-300 leading-relaxed"></p>
		<div class="flex gap-2 pt-2"><button id="pmDm" class="flex-1 py-2 rounded-full bg-orange-600 hover:bg-orange-500 text-sm font-medium">DM Seller</button><a href="Store.html" id="pmOpenStore" class="flex-1 py-2 rounded-full bg-white/10 hover:bg-white/20 text-sm font-medium border border-white/10 text-center flex items-center justify-center">Visit Store</a></div>
	</div></div></div></div>

	<script>
    // Sell & Boost Modal Logic
	(function(){
		const sellModal = document.getElementById('sellModal'), openBtn = document.getElementById('openSell'), closeBtn = document.getElementById('closeSell'), form = document.getElementById('sellForm');
        const boostModal = document.getElementById('boostModal'), boostCheckbox = document.getElementById('sellBoost'), cancelBoost = document.getElementById('cancelBoost'), confirmBoost = document.getElementById('confirmBoost');
		function openSell(){ sellModal.classList.remove('hidden'); document.body.classList.add('no-scroll'); lucide.createIcons(); }
		function closeSell(){ sellModal.classList.add('hidden'); document.body.classList.remove('no-scroll'); form.reset(); document.getElementById('sellPreview').innerHTML=''; }
        function openBoost(){ boostModal.classList.remove('hidden'); }
        function closeBoost(){ boostModal.classList.add('hidden'); }
		openBtn.addEventListener('click', openSell); closeBtn.addEventListener('click', closeSell);
        cancelBoost.addEventListener('click', ()=>{ closeBoost(); closeSell(); /* Add logic to post without boost */ });
        confirmBoost.addEventListener('click', ()=>{ alert('Payment successful! Your item is boosted.'); closeBoost(); closeSell(); /* Add logic to post WITH boost */ });
		form.addEventListener('submit', e=>{ e.preventDefault(); if(boostCheckbox.checked){ openBoost(); } else { alert('Item listed successfully!'); closeSell(); /* Add logic to post without boost */ } });
	})();
	// Product Detail Modal Logic
	(function(){
		const modal=document.getElementById('productModal'), closeBtn=document.getElementById('closeProduct');
		function close(){ modal.classList.add('hidden'); document.body.classList.remove('no-scroll'); }
		window.openProductModal=function(id){
            const product = sampleProducts.find(p => p.id == id);
            if (!product) return;
			document.getElementById('pmImage').style.backgroundImage=`url('${product.img}')`;
			document.getElementById('pmTitle').textContent=product.title;
			document.getElementById('pmPrice').textContent='GH₵'+product.price.toLocaleString();
            document.getElementById('pmSeller').innerHTML = `Sold by <span class="font-semibold text-orange-400">${product.seller}</span> <span class="flex items-center gap-1"><i data-lucide="star" class="w-3 h-3 fill-yellow-400 text-yellow-400"></i>${product.rating.toFixed(1)}</span>`;
			document.getElementById('pmDesc').textContent=product.desc||'No description provided.';
			modal.classList.remove('hidden'); document.body.classList.add('no-scroll'); lucide.createIcons();
		};
		closeBtn.addEventListener('click', close);
	})();
	</script>
	<!-- Search Modal removed; centralized version injected globally -->
</body>
</html>
