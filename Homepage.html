<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Paired</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link rel="stylesheet" href="styles.css" />
  <script src="theme.js"></script>
  <script>window.PAGE_ACTIVE='home';</script>
  <script src="shared-ui.js"></script>
  <style>
    /* Orbs animation */
    .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.6; animation: float 20s infinite ease-in-out; }
    .orb1 { width: 300px; height: 300px; background: orange; top: 5%; left: 5%; animation-duration: 25s; }
    .orb2 { width: 250px; height: 250px; background: purple; bottom: 8%; right: 5%; animation-duration: 22s; }
    .orb3 { width: 220px; height: 220px; background: teal; top: 35%; left: 50%; animation-duration: 28s; }
    @keyframes float { 0%, 100% { transform: translateY(0) translateX(0); } 50% { transform: translateY(-30px) translateX(30px); } }
    /* Hide scrollbar utility */
    .no-scrollbar { scrollbar-width: none; -ms-overflow-style: none; }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    /* Sidebar transition */
    #sidebar { transition: transform 0.3s ease-in-out; }
    .sidebar-open { transform: translateX(0) !important; }
    #sidebar-overlay { transition: opacity 0.3s ease-in-out; }
  </style>
</head>
<body class="bg-black text-white min-h-screen overflow-y-auto overflow-x-hidden relative flex justify-center">

  <div class="absolute inset-0 -z-10">
    <div class="orb orb1"></div>
    <div class="orb orb2"></div>
    <div class="orb orb3"></div>
  </div>
  
  <!-- Header + composer injected by shared-ui.js -->

  <main id="feed" class="w-full max-w-sm mx-auto relative z-10 pb-10" data-adjust-offset>
  <div class="space-y-5 px-4 pt-4" id="posts">
      <article class="post bg-white/5 border border-white/10 backdrop-blur rounded-xl overflow-hidden" data-post-id="1">
        <div class="flex items-start gap-3 px-4 pt-4">
          <div class="w-10 h-10 rounded-full overflow-hidden border-2 border-orange-500"><img src="https://picsum.photos/id/1005/80/80" alt="avatar" class="w-full h-full object-cover" /></div>
          <div class="flex-1">
            <div class="flex items-center gap-2 flex-wrap"><p class="text-sm font-semibold">Kwame Boateng</p><span class="text-[10px] px-1.5 py-0.5 rounded bg-orange-600/30 text-orange-300">New</span></div>
            <p class="text-[11px] text-gray-400">2 hrs ago · UCC Campus</p>
          </div>
          <button class="p-1 text-gray-400 hover:text-white"><i data-lucide="ellipsis"></i></button>
        </div>
        <div class="px-4 pt-3 text-sm leading-relaxed text-gray-200">Had an amazing study group today. Proud of the progress everyone's making! #Focus #Growth</div>
        <div class="mt-3 bg-black/30"><img src="https://picsum.photos/id/1040/600/400" alt="post media" class="w-full object-cover max-h-80"></div>
        <div class="px-4 pt-3 pb-2 text-[11px] flex items-center justify-between text-gray-400"><div><span class="like-count font-medium text-orange-400">128</span> likes</div><div>34 comments · 9 shares</div></div><div class="h-px bg-white/10 mx-4"></div>
        <div class="flex px-2 py-1 text-[12px] font-medium">
          <button class="post-like flex-1 flex items-center justify-center gap-1 py-2 rounded-md hover:bg-white/10 transition"><i data-lucide="thumbs-up" class="w-4 h-4"></i><span>Like</span></button>
          <button class="post-comment flex-1 flex items-center justify-center gap-1 py-2 rounded-md hover:bg-white/10 transition"><i data-lucide="message-square" class="w-4 h-4"></i><span>Comment</span></button>
          <button class="post-share flex-1 flex items-center justify-center gap-1 py-2 rounded-md hover:bg-white/10 transition"><i data-lucide="share-2" class="w-4 h-4"></i><span>Share</span></button>
        </div>
      </article>
      
      <section class="bg-white/5 border border-white/10 backdrop-blur rounded-xl p-3">
        <div class="flex items-center justify-between mb-2">
          <h2 class="font-semibold text-sm tracking-wide flex items-center gap-2"><i data-lucide="calendar" class="w-4 h-4 text-orange-400"></i>Upcoming Events on Campus</h2>
          <button class="text-[11px] text-orange-400 hover:underline">See all</button>
        </div>
        <div class="overflow-x-auto no-scrollbar -mx-1 px-1" style="-webkit-overflow-scrolling:touch;">
          <div class="flex space-x-3 w-max">
            <div class="cursor-pointer w-48 flex-shrink-0 bg-white/5 rounded-lg border border-white/10 overflow-hidden">
              <div class="h-24 w-full bg-center bg-cover" style="background-image:url('https://picsum.photos/id/10/300/200')"></div>
              <div class="p-2 space-y-1">
                <p class="text-xs font-semibold leading-tight">SRC Week: Bonfire Night</p>
                <p class="text-[10px] text-gray-400">Fri, Aug 29 • 8:00 PM</p>
                <button class="event-details-btn w-full mt-1 bg-orange-600 hover:bg-orange-500 text-[10px] font-medium rounded px-1.5 py-1.5"
                  data-title="SRC Week: Bonfire Night"
                  data-time="Fri, Aug 29 • 8:00 PM"
                  data-image="https://picsum.photos/id/10/600/400"
                  data-description="Experience the electrifying Bonfire Night as part of SRC Week celebrations. Music, performances, and networking under the stars. Come early for the opening drum circle!"
                  data-location="Main Quadrangle"
                  data-organizer="SRC Week Committee"
                >See Details</button>
              </div>
            </div>
            <div class="cursor-pointer w-48 flex-shrink-0 bg-white/5 rounded-lg border border-white/10 overflow-hidden">
              <div class="h-24 w-full bg-center bg-cover" style="background-image:url('https://picsum.photos/id/22/300/200')"></div>
              <div class="p-2 space-y-1">
                <p class="text-xs font-semibold leading-tight">CASFORD Hall Tech Summit</p>
                <p class="text-[10px] text-gray-400">Sat, Aug 30 • 10:00 AM</p>
                <button class="event-details-btn w-full mt-1 bg-orange-600 hover:bg-orange-500 text-[10px] font-medium rounded px-1.5 py-1.5"
                  data-title="CASFORD Hall Tech Summit"
                  data-time="Sat, Aug 30 • 10:00 AM"
                  data-image="https://picsum.photos/id/22/600/400"
                  data-description="A full-day technology summit featuring student innovators, alumni speakers, startup demos, and hands-on workshops. Bring your laptop and curiosity."
                  data-location="CASFORD Main Auditorium"
                  data-organizer="CASFORD Hall Council"
                >See Details</button>
              </div>
            </div>
            <div class="cursor-pointer w-48 flex-shrink-0 bg-white/5 rounded-lg border border-white/10 overflow-hidden">
                <div class="h-24 w-full bg-center bg-cover" style="background-image:url('https://picsum.photos/id/30/300/200')"></div>
                <div class="p-2 space-y-1">
                  <p class="text-xs font-semibold leading-tight">Valco Hall Movie Night</p>
                  <p class="text-[10px] text-gray-400">Sat, Aug 30 • 7:00 PM</p>
                  <button class="event-details-btn w-full mt-1 bg-orange-600 hover:bg-orange-500 text-[10px] font-medium rounded px-1.5 py-1.5"
                    data-title="Valco Hall Movie Night"
                    data-time="Sat, Aug 30 • 7:00 PM"
                    data-image="https://picsum.photos/id/30/600/400"
                    data-description="Relax with friends at an outdoor movie screening hosted by Valco Hall. Free popcorn for the first 100 attendees. Vote live for the second film!"
                    data-location="Valco Hall Courtyard"
                    data-organizer="Valco Hall Entertainment"
                  >See Details</button>
                </div>
              </div>
          </div>
        </div>
      </section>

      <article class="post bg-white/5 border border-purple-500/30 backdrop-blur rounded-xl overflow-hidden" data-post-id="ad-1">
        <div class="flex items-start gap-3 px-4 pt-4">
          <div class="w-10 h-10 rounded-full overflow-hidden border-2 border-purple-500"><img src="https://picsum.photos/seed/biz1/80/80" alt="avatar" class="w-full h-full object-cover" /></div>
          <div class="flex-1">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-semibold">Campus Bites Eatery</p>
                    <p class="text-[11px] text-gray-400">Sponsored · Near Science Market</p>
                </div>
                <span class="text-[10px] px-1.5 py-0.5 rounded-full bg-gray-400/20 text-gray-300">Ad</span>
            </div>
          </div>
        </div>
        <div class="px-4 pt-3 text-sm leading-relaxed text-gray-200">Hungry after lectures? Grab a delicious plate of Jollof for just GH₵20. We deliver to all halls!</div>
        <div class="mt-3 bg-black/30"><img src="https://picsum.photos/seed/jollof/600/400" alt="post media" class="w-full object-cover max-h-80"></div>
        <div class="p-3">
            <button class="ad-details-btn w-full flex items-center justify-center gap-2 py-2 rounded-md bg-orange-600 hover:bg-orange-500 text-sm font-semibold transition"
              data-ad-title="Campus Bites Eatery"
              data-ad-tagline="Hungry after lectures? Grab a delicious plate of Jollof for just GH₵20."
              data-ad-body="We deliver fresh, affordable meals to all halls within 20 minutes. Order Jollof, Waakye, Fried Rice, and more. Daily chef specials and discounts for bulk study groups. Secure mobile money payment accepted."
              data-ad-image="https://picsum.photos/seed/jollof/800/500"
              data-ad-location="Near Science Market"
              data-ad-contact="@CampusBites_UCC"
            >
                <span>Find out more</span><i data-lucide="arrow-right" class="w-4 h-4"></i>
            </button>
        </div>
      </article>

      <section class="bg-white/5 border border-white/10 backdrop-blur rounded-xl p-3">
        <div class="flex items-center justify-between mb-2"><h2 class="font-semibold text-sm tracking-wide">People you may know</h2><button class="text-[11px] text-orange-400 hover:underline">See all</button></div>
        <div class="overflow-x-auto no-scrollbar -mx-1 px-1" style="-webkit-overflow-scrolling:touch;">
          <div class="flex space-x-3 w-max">
            <div class="people-card cursor-pointer w-32 flex-shrink-0 bg-white/5 rounded-lg border border-white/10 overflow-hidden">
              <div class="h-24 w-full bg-center bg-cover" style="background-image:url('https://picsum.photos/id/1027/140/140')"></div>
              <div class="p-2 space-y-1"><p class="text-xs font-semibold leading-tight">Aisha Mensah</p><p class="text-[10px] text-gray-400">6 mutual friends</p><div class="flex gap-1 pt-1"><button class="flex-1 add-friend bg-orange-600 hover:bg-orange-500 text-[10px] font-medium rounded px-1.5 py-1">Add</button><button class="remove-card border border-white/20 hover:bg-white/10 rounded px-1.5 py-1 text-[10px]">X</button></div></div>
            </div>
            <div class="people-card cursor-pointer w-32 flex-shrink-0 bg-white/5 rounded-lg border border-white/10 overflow-hidden">
              <div class="h-24 w-full bg-center bg-cover" style="background-image:url('https://picsum.photos/id/1005/140/140')"></div>
              <div class="p-2 space-y-1"><p class="text-xs font-semibold leading-tight">Kwame Boateng</p><p class="text-[10px] text-gray-400">2 mutual friends</p><div class="flex gap-1 pt-1"><button class="flex-1 add-friend bg-orange-600 hover:bg-orange-500 text-[10px] font-medium rounded px-1.5 py-1">Add</button><button class="remove-card border border-white/20 hover:bg-white/10 rounded px-1.5 py-1 text-[10px]">X</button></div></div>
            </div>
          </div>
        </div>
      </section>

      <article class="post bg-white/5 border border-white/10 backdrop-blur rounded-xl overflow-hidden" data-post-id="3">
        <div class="flex items-start gap-3 px-4 pt-4">
            <div class="w-10 h-10 rounded-full overflow-hidden border-2 border-orange-500"><img src="https://picsum.photos/id/1018/80/80" alt="avatar" class="w-full h-full object-cover" /></div>
            <div class="flex-1"><p class="text-sm font-semibold">Esi Nyarko</p><p class="text-[11px] text-gray-400">Yesterday · Accra</p></div>
            <button class="p-1 text-gray-400 hover:text-white"><i data-lucide="ellipsis"></i></button>
        </div>
        <div class="px-4 pt-3 text-sm leading-relaxed text-gray-200">Throwback to last weekend's beach cleanup! Proud of everyone who showed up. 🌊♻️</div>
        <div class="mt-3 grid grid-cols-2 gap-1 px-4 pb-1">
            <img src="https://picsum.photos/id/1067/400/400" class="w-full h-32 object-cover rounded" alt="img1" />
            <img src="https://picsum.photos/id/1074/400/400" class="w-full h-32 object-cover rounded" alt="img2" />
        </div>
        <div class="px-4 pt-2 pb-2 text-[11px] flex items-center justify-between text-gray-400"><div><span class="like-count font-medium text-orange-400">302</span> likes</div><div>88 comments · 21 shares</div></div><div class="h-px bg-white/10 mx-4"></div>
        <div class="flex px-2 py-1 text-[12px] font-medium">
            <button class="post-like flex-1 flex items-center justify-center gap-1 py-2 rounded-md hover:bg-white/10 transition"><i data-lucide="thumbs-up" class="w-4 h-4"></i><span>Like</span></button>
            <button class="post-comment flex-1 flex items-center justify-center gap-1 py-2 rounded-md hover:bg-white/10 transition"><i data-lucide="message-square" class="w-4 h-4"></i><span>Comment</span></button>
            <button class="post-share flex-1 flex items-center justify-center gap-1 py-2 rounded-md hover:bg-white/10 transition"><i data-lucide="share-2" class="w-4 h-4"></i><span>Share</span></button>
        </div>
      </article>

    </div>
  </main>
  
  <div id="composerModal" class="fixed inset-0 z-[1000] hidden" aria-hidden="true">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
    <div class="absolute inset-x-0 top-0 mx-auto w-full max-w-sm p-4 animate-fade-in">
      <div class="bg-white/10 border border-white/20 rounded-2xl shadow-xl overflow-hidden flex flex-col max-h-[90vh]">
        <div class="flex items-center justify-between px-4 py-3 border-b border-white/10">
          <h3 class="text-sm font-semibold">Create Post</h3>
          <button id="closeComposer" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10" aria-label="Close create post"><i data-lucide="x" class="w-5 h-5"></i></button>
        </div>
        <div class="p-4 space-y-4 overflow-y-auto">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-full overflow-hidden border-2 border-orange-500"><img src="https://picsum.photos/id/1019/80/80" class="w-full h-full object-cover" alt="avatar" /></div>
            <div>
              <p class="text-sm font-semibold">You</p>
              <select class="bg-black/30 text-xs px-2 py-1 rounded border border-white/10 focus:outline-none"><option>Friends</option><option>Only Me</option><option>Public</option></select>
            </div>
          </div>
          <textarea id="composerText" rows="4" placeholder="What's on your mind?" class="w-full bg-black/30 rounded-lg p-3 text-sm resize-none focus:outline-none placeholder-gray-400"></textarea>
          <!-- Hidden file input for Photo/Video uploads -->
          <input id="composerFile" type="file" accept="image/*,video/*" multiple class="hidden" />
          <div id="mediaPreview" class="hidden"></div>
          <div class="flex gap-2 flex-wrap">
            <button id="addPhotoBtn" class="flex items-center gap-1 text-xs px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10"><i data-lucide="image" class="w-4 h-4"></i>Photo/Video</button>
            <button class="flex items-center gap-1 text-xs px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10"><i data-lucide="calendar-plus" class="w-4 h-4"></i>Create Event</button>
            <button class="flex items-center gap-1 text-xs px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10"><i data-lucide="map-pin" class="w-4 h-4"></i>Check in</button>
          </div>
        </div>
        <div class="p-4 border-t border-white/10">
          <button id="postSubmit" class="w-full py-2 rounded-lg bg-orange-600 hover:bg-orange-500 font-medium text-sm disabled:opacity-40 disabled:cursor-not-allowed">Post</button>
        </div>
      </div>
    </div>
  </div>

  <div id="shareModal" class="fixed inset-0 z-[998] hidden"><div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div><div class="absolute inset-x-0 top-0 mx-auto w-full max-w-sm p-4 animate-fade-in"><div class="bg-white/10 border border-white/20 rounded-2xl p-5 shadow-xl relative space-y-4"><div class="flex items-center justify-between"><h3 class="text-sm font-semibold">Share Post</h3><button id="closeShare" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10" aria-label="Close share"><i data-lucide="x" class="w-5 h-5"></i></button></div><div class="grid grid-cols-3 gap-3 text-center text-[11px]"><button class="share-action flex flex-col items-center gap-2 p-3 rounded-lg bg-white/5 hover:bg-white/10" data-action="feed"><i data-lucide="rss" class="w-5 h-5"></i><span>Feed</span></button><button class="share-action flex flex-col items-center gap-2 p-3 rounded-lg bg-white/5 hover:bg-white/10" data-action="story"><i data-lucide="circle" class="w-5 h-5"></i><span>Story</span></button><button class="share-action flex flex-col items-center gap-2 p-3 rounded-lg bg-white/5 hover:bg-white/10" data-action="message"><i data-lucide="send" class="w-5 h-5"></i><span>Message</span></button><button class="col-span-3 share-copy flex items-center justify-center gap-2 w-full py-2 rounded-lg bg-orange-600 hover:bg-orange-500 text-sm font-medium"><i data-lucide="link" class="w-4 h-4"></i><span>Copy Link</span></button></div><p id="shareStatus" class="text-center text-[11px] text-green-400 hidden">Link copied!</p></div></div></div>
  <div id="searchModal" class="fixed inset-0 z-[999] hidden"><div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div><div class="absolute inset-x-0 top-0 mx-auto w-full max-w-sm p-4 animate-fade-in"><div class="bg-white/10 border border-white/20 rounded-2xl p-4 shadow-xl relative"><div class="flex items-center gap-2"><i data-lucide="search" class="w-5 h-5 text-gray-300"></i><input id="searchInputModal" type="text" placeholder="Search..." class="flex-1 bg-transparent outline-none text-sm placeholder-gray-400" /><button id="closeSearch" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10" aria-label="Close search"><i data-lucide="x" class="w-5 h-5"></i></button></div><div id="searchResults" class="mt-4 max-h-72 overflow-y-auto space-y-2 text-sm"></div><div id="searchEmpty" class="mt-6 text-center text-xs text-gray-400">Type to start searching</div></div></div></div>
  <!-- Event Details Modal -->
  <div id="eventDetailsModal" class="fixed inset-0 z-[1200] hidden" aria-hidden="true">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
    <div class="absolute inset-x-0 top-0 mx-auto w-full max-w-sm p-4 animate-fade-in">
      <div class="bg-white/10 border border-white/20 rounded-2xl shadow-xl overflow-hidden flex flex-col max-h-[90vh]">
        <div class="flex items-center justify-between px-4 py-3 border-b border-white/10">
          <h3 id="eventTitle" class="text-sm font-semibold">Event Title</h3>
          <button id="closeEventDetails" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10" aria-label="Close event details"><i data-lucide="x" class="w-5 h-5"></i></button>
        </div>
        <div id="eventContent" class="overflow-y-auto">
          <div class="w-full aspect-video bg-black/30 relative"><img id="eventImage" src="" alt="event" class="w-full h-full object-cover" /></div>
          <div class="p-4 space-y-3 text-sm">
            <p id="eventTime" class="text-xs text-orange-300 font-medium"></p>
            <p id="eventDescription" class="leading-relaxed text-gray-200"></p>
            <div class="text-xs text-gray-400 space-y-1">
              <p><i data-lucide="map-pin" class="inline-block w-4 h-4 mr-1"></i><span id="eventLocation">Location</span></p>
              <p><i data-lucide="user" class="inline-block w-4 h-4 mr-1"></i>Organizer: <span id="eventOrganizer">Organizer Name</span></p>
            </div>
            <button id="dmOrganizerBtn" class="w-full flex items-center justify-center gap-2 py-2 rounded-md bg-orange-600 hover:bg-orange-500 text-sm font-semibold transition"><i data-lucide="message-circle" class="w-4 h-4"></i><span>DM Organizer</span></button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Ad Details Modal -->
  <div id="adDetailsModal" class="fixed inset-0 z-[1150] hidden" aria-hidden="true">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
    <div class="absolute inset-x-0 top-0 mx-auto w-full max-w-sm p-4 animate-fade-in">
      <div class="bg-white/10 border border-white/20 rounded-2xl shadow-xl overflow-hidden flex flex-col max-h-[90vh]">
        <div class="flex items-center justify-between px-4 py-3 border-b border-white/10">
          <h3 id="adTitle" class="text-sm font-semibold">Ad Title</h3>
          <button id="closeAdDetails" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10" aria-label="Close ad details"><i data-lucide="x" class="w-5 h-5"></i></button>
        </div>
        <div id="adContent" class="overflow-y-auto">
          <div class="w-full aspect-video bg-black/30 relative"><img id="adImage" src="" alt="ad" class="w-full h-full object-cover" /></div>
          <div class="p-4 space-y-3 text-sm">
            <p id="adTagline" class="text-xs text-orange-300 font-medium"></p>
            <p id="adBody" class="leading-relaxed text-gray-200"></p>
            <div class="text-xs text-gray-400 space-y-1">
              <p><i data-lucide="map-pin" class="inline-block w-4 h-4 mr-1"></i><span id="adLocation">Location</span></p>
              <p><i data-lucide="at-sign" class="inline-block w-4 h-4 mr-1"></i><span id="adContact">Contact</span></p>
            </div>
            <button id="adDmBtn" class="w-full flex items-center justify-center gap-2 py-2 rounded-md bg-orange-600 hover:bg-orange-500 text-sm font-semibold transition"><i data-lucide="messages-square" class="w-4 h-4"></i><span>Message Vendor</span></button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <style>@keyframes fade-in {from{opacity:0; transform:translateY(-8px);} to{opacity:1; transform:translateY(0);} } .animate-fade-in { animation: fade-in .25s ease; } .no-scroll { overflow: hidden !important; }</style>
  <style>
    /* Light theme visibility for event date/time */
    .theme-light #eventDetailsModal #eventTime { color:#000 !important; }
  </style>

  <script>
  lucide.createIcons();

  // Bind existing header "What's on your mind" trigger (injected by shared-ui.js) without adding duplicate bar
  (function bindHeaderComposer(){
    const MODAL_ID='composerModal';
    const findTrigger=()=>{
      // Preferred explicit id
      let trigger=document.getElementById('openComposerModal');
      if(trigger) return trigger;
      // Fallback: scan for element text / placeholder pattern
      const candidates=[...document.querySelectorAll('button,div,span,input,textarea')];
      const pattern=/(what(?:'|’)?s on your mind|what do you (?:you )?(?:see|think))/i;
      trigger=candidates.find(el=>{
        if(el.id===MODAL_ID) return false;
        const txt=(el.placeholder||el.innerText||'').trim();
        return pattern.test(txt);
      });
      if(trigger && !trigger.id) trigger.id='openComposerModal';
      return trigger||null;
    };
    const attach=(trigger)=>{
      if(!trigger || trigger.dataset.boundComposer) return;
      trigger.dataset.boundComposer='1';
      trigger.classList.add('cursor-pointer');
      trigger.setAttribute('role','button');
      trigger.setAttribute('tabindex','0');
      const open=()=>{
        const modal=document.getElementById(MODAL_ID);
        if(!modal) return;
        modal.classList.remove('hidden');
        document.body.classList.add('no-scroll');
        setTimeout(()=> document.getElementById('composerText')?.focus(),60);
      };
      trigger.addEventListener('click', open);
      // Keyboard: Enter always opens. Space opens only if trigger isn't a typing field.
      trigger.addEventListener('keydown', e=>{
        if(e.key==='Enter') { e.preventDefault(); open(); return; }
        if(e.key===' '){
          // Allow spacebar for actual INPUT/TEXTAREA/contentEditable so users can type spaces
            if(trigger.tagName==='INPUT' || trigger.tagName==='TEXTAREA' || trigger.isContentEditable) return; 
            e.preventDefault();
            open();
        }
      });
      // Bind image/photo icon near trigger if present
      const parent=trigger.closest('header, .header, nav, .flex, .grid, body') || document.body;
      const photoBtn=[...parent.querySelectorAll('[data-composer-photo], .composer-photo-trigger, button, i')]
        .find(el=> el !== trigger && /image|photo/i.test(el.getAttribute('aria-label')||'') || (el.tagName==='I' && el.getAttribute('data-lucide')==='image'));
      if(photoBtn && !photoBtn.dataset.boundPhoto){
        photoBtn.dataset.boundPhoto='1';
        photoBtn.addEventListener('click', ()=>{
          open();
          setTimeout(()=> document.getElementById('addPhotoBtn')?.click(), 120);
        });
      }
    };
    const attempt=()=>{ const t=findTrigger(); if(t) attach(t); };
    attempt();
    const mo=new MutationObserver(()=> attempt());
    mo.observe(document.documentElement,{childList:true,subtree:true});
    // Stop observing after a few seconds to save performance
    setTimeout(()=> mo.disconnect(), 6000);
  })();

    // Sidebar Logic
  // sidebar logic handled by shared-ui.js

    // Interaction logic
    document.addEventListener('click', (e)=>{
      const likeBtn = e.target.closest('.post-like');
      if(likeBtn){
        const post = likeBtn.closest('.post');
        const countEl = post.querySelector('.like-count');
        let count = parseInt(countEl.textContent,10);
        const active = likeBtn.classList.toggle('text-orange-400');
        likeBtn.classList.toggle('font-semibold', active);
        likeBtn.querySelector('i')?.classList.toggle('fill-orange-500');
        count += active ? 1 : -1;
        if(count < 0) count = 0;
        countEl.textContent = count;
        return;
      }
      if(e.target.closest('.post-comment')){ window.location.href='comments.html'; return; }
      if(e.target.closest('.post-share')){ openShareModal(); return; }
      const addFriend = e.target.closest('.add-friend');
      if(addFriend){
        addFriend.textContent = 'Added';
        addFriend.disabled = true;
        addFriend.classList.remove('bg-orange-600','hover:bg-orange-500');
        addFriend.classList.add('bg-green-600');
        return;
      }
      const removeCard = e.target.closest('.remove-card');
      if(removeCard){ removeCard.closest('.w-32')?.remove(); return; }
      if(e.target.closest('.people-card') && !e.target.closest('button')){ window.location.href='PeopleProfile.html'; return; }
      const postArticle = e.target.closest('article.post');
      if(postArticle && !e.target.closest('button')){ window.location.href='PeopleProfile.html'; return; }
    });

    // Modal Scripts (Share, Composer, Search)...
    function openShareModal(){ document.getElementById('shareModal').classList.remove('hidden'); document.body.classList.add('no-scroll'); lucide.createIcons(); }
    function closeShareModal(){ document.getElementById('shareModal').classList.add('hidden'); document.body.classList.remove('no-scroll'); document.getElementById('shareStatus').classList.add('hidden');}
    document.addEventListener('click', e=>{ if(e.target.id==='closeShare' || e.target.id==='shareModal') closeShareModal(); const action = e.target.closest('.share-action'); if(action){ closeShareModal(); alert('Shared via '+ action.dataset.action); } if(e.target.closest('.share-copy')){ navigator.clipboard?.writeText(window.location.href); const status = document.getElementById('shareStatus'); status.classList.remove('hidden'); setTimeout(()=> status.classList.add('hidden'), 2000); } });
    (function(){
      const modal=document.getElementById('composerModal');
      const openField=document.getElementById('openComposerModal');
      const closeBtn=document.getElementById('closeComposer');
      const fileInput=document.getElementById('composerFile');
      const addPhotoBtn=document.getElementById('addPhotoBtn');
      const preview=document.getElementById('mediaPreview');
      const textArea=document.getElementById('composerText');
      const submit=document.getElementById('postSubmit');
      if(!modal||!textArea||!submit) return;
      function open(){modal.classList.remove('hidden');document.body.classList.add('no-scroll');textArea.focus();}
      function close(){modal.classList.add('hidden');document.body.classList.remove('no-scroll');textArea.value='';if(preview){preview.innerHTML='';preview.className='hidden';}if(fileInput) fileInput.value='';updateState();}
      function updateState(){submit.disabled=!textArea.value.trim() && !(preview && preview.children.length);} 
      openField?.addEventListener('click',open);
      closeBtn?.addEventListener('click',close);
      modal.addEventListener('click',e=>{if(e.target===modal) close();});
      addPhotoBtn?.addEventListener('click',()=> fileInput?.click());
      fileInput?.addEventListener('change',()=>{
        if(!preview) return; preview.innerHTML=''; const files=[...(fileInput.files||[])].slice(0,4);
        if(files.length){ preview.className='grid grid-cols-2 gap-2'; }
        files.forEach(f=>{ const url=URL.createObjectURL(f); const el=document.createElement(f.type.startsWith('video')?'video':'img'); el.src=url; el.className='w-full h-32 object-cover rounded-lg'; if(el.tagName==='VIDEO') el.controls=true; preview.appendChild(el); });
        updateState();
      });
      textArea.addEventListener('input',updateState);
      submit.addEventListener('click',()=>{
        if(submit.disabled) return; const posts=document.getElementById('posts'); if(!posts) return;
        const body=textArea.value.trim(); if(!body && !(preview && preview.children.length)) return;
        const mediaHTML=preview && preview.children.length ? [...preview.children].map(c=> c.tagName==='IMG'?`<img src="${c.src}" class='w-full object-cover max-h-80'/>`:`<video src='${c.src}' class='w-full max-h-80' controls></video>`).join('') : '';
        const newPost=document.createElement('article'); newPost.className='post bg-white/5 border border-white/10 backdrop-blur rounded-xl overflow-hidden';
        newPost.innerHTML=`<div class='flex items-start gap-3 px-4 pt-4'><div class='w-10 h-10 rounded-full overflow-hidden border-2 border-orange-500'><img src='https://picsum.photos/id/1019/80/80' class='w-full h-full object-cover' alt='avatar'/></div><div class='flex-1'><p class='text-sm font-semibold'>You</p><p class='text-[11px] text-gray-400'>Just now · Mobile</p></div><button class='p-1 text-gray-400 hover:text-white'><i data-lucide="ellipsis"></i></button></div><div class='px-4 pt-3 text-sm leading-relaxed text-gray-200'></div>${mediaHTML?`<div class='mt-3 bg-black/30 media-block'>${mediaHTML}</div>`:''}<div class='px-4 pt-3 pb-2 text-[11px] flex items-center justify-between text-gray-400'><div><span class='like-count font-medium text-orange-400'>0</span> likes</div><div>0 comments · 0 shares</div></div><div class='h-px bg-white/10 mx-4'></div><div class='flex px-2 py-1 text-[12px] font-medium'><button class='post-like flex-1 flex items-center justify-center gap-1 py-2 rounded-md hover:bg-white/10 transition'><i data-lucide='thumbs-up' class='w-4 h-4'></i><span>Like</span></button><button class='post-comment flex-1 flex items-center justify-center gap-1 py-2 rounded-md hover:bg-white/10 transition'><i data-lucide='message-square' class='w-4 h-4'></i><span>Comment</span></button><button class='post-share flex-1 flex items-center justify-center gap-1 py-2 rounded-md hover:bg-white/10 transition'><i data-lucide='share-2' class='w-4 h-4'></i><span>Share</span></button></div>`;
        newPost.querySelector('.px-4.pt-3.text-sm').textContent=body;
        posts.prepend(newPost); if(window.lucide) lucide.createIcons(); close();
      });
      updateState();
    })();
    (function(){const openBtn=document.getElementById('openSearch'),modal=document.getElementById('searchModal'),closeBtn=document.getElementById('closeSearch'),input=document.getElementById('searchInputModal'),results=document.getElementById('searchResults'),empty=document.getElementById('searchEmpty'),sample=['Ama Kusi','Kwame Boateng','Marketplace: Laptop','Post: Productivity tips','Esi Nyarko','Event: Hack Night'];function open(){modal.classList.remove('hidden');document.body.classList.add('no-scroll');setTimeout(()=>input.focus(),50);}function close(){modal.classList.add('hidden');document.body.classList.remove('no-scroll');input.value='';results.innerHTML='';empty.classList.remove('hidden');}openBtn?.addEventListener('click',open);closeBtn?.addEventListener('click',close);modal.addEventListener('click',e=>{if(e.target===modal)close();});input.addEventListener('input',()=>{const q=input.value.trim().toLowerCase();results.innerHTML='';if(!q){empty.classList.remove('hidden');return;}empty.classList.add('hidden');const filtered=sample.filter(s=>s.toLowerCase().includes(q));if(!filtered.length){results.innerHTML='<div class="text-xs text-gray-400 text-center py-4">No matches</div>';return;}filtered.forEach(item=>{const div=document.createElement('div');div.className='px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 cursor-pointer';div.textContent=item;results.appendChild(div);});});})();
    // Event Details logic
    (function(){
      const modal=document.getElementById('eventDetailsModal');
      if(!modal) return;
      const titleEl=document.getElementById('eventTitle');
      const timeEl=document.getElementById('eventTime');
      const descEl=document.getElementById('eventDescription');
      const imgEl=document.getElementById('eventImage');
      const locEl=document.getElementById('eventLocation');
      const orgEl=document.getElementById('eventOrganizer');
      const dmBtn=document.getElementById('dmOrganizerBtn');
      const closeBtn=document.getElementById('closeEventDetails');
      function open(){ modal.classList.remove('hidden'); document.body.classList.add('no-scroll'); if(window.lucide) lucide.createIcons(); }
      function close(){ modal.classList.add('hidden'); document.body.classList.remove('no-scroll'); }
      closeBtn?.addEventListener('click',close);
      modal.addEventListener('click',e=>{ if(e.target===modal) close(); });
      dmBtn?.addEventListener('click',()=>{ window.location.href='Dm.html'; });
      document.addEventListener('click',e=>{
        const btn=e.target.closest('.event-details-btn');
        if(!btn) return;
        titleEl.textContent=btn.dataset.title||'Event';
        // Light theme custom formatting request: e.g., 'Sat, Aug 30 • 7:00 PM' -> 'sat august 30, 7:00pm'
        const rawTime=btn.dataset.time||'';
        function formatForLight(str){
          if(!str) return str;
            const monthMap={Jan:'January',Feb:'February',Mar:'March',Apr:'April',May:'May',Jun:'June',Jul:'July',Aug:'August',Sep:'September',Oct:'October',Nov:'November',Dec:'December'};
            // Remove separators like '•'
            let cleaned=str.replace(/\s*•\s*/,' ').replace(/\s+/g,' ').trim();
            // Example patterns: 'Sat, Aug 30 7:00 PM' or 'Sat, Aug 30 7:00 PM'
            // Remove comma after day abbrev
            cleaned=cleaned.replace(/^(\w{3}),\s*/,'$1 ');
            const parts=cleaned.split(' '); // [DayAbbrev, MonAbbrev, DayNum, Time, AM/PM]
            if(parts.length>=5){
              const dayAbbrev=parts[0];
              const monAbbrev=parts[1];
              const dayNum=parts[2];
              const time=parts[3];
              const ampm=parts[4].toLowerCase();
              const fullMonth=monthMap[monAbbrev]||monAbbrev;
              return `${dayAbbrev.toLowerCase()} ${fullMonth.toLowerCase()} ${dayNum}, ${time.toLowerCase()}${ampm}`;
            }
            return str.toLowerCase();
        }
        if(document.documentElement.classList.contains('theme-light')){
          timeEl.textContent=formatForLight(rawTime);
        } else {
          timeEl.textContent=rawTime;
        }
        descEl.textContent=btn.dataset.description||'';
        imgEl.src=btn.dataset.image||'';
        locEl.textContent=btn.dataset.location||'';
        orgEl.textContent=btn.dataset.organizer||'';
        open();
      });
    })();
    // Ad Details logic
    ;(function(){
      const modal=document.getElementById('adDetailsModal');
      if(!modal) return;
      const title=document.getElementById('adTitle');
      const tagline=document.getElementById('adTagline');
      const body=document.getElementById('adBody');
      const img=document.getElementById('adImage');
      const loc=document.getElementById('adLocation');
      const contact=document.getElementById('adContact');
      const dmBtn=document.getElementById('adDmBtn');
      const closeBtn=document.getElementById('closeAdDetails');
      function open(){ modal.classList.remove('hidden'); document.body.classList.add('no-scroll'); if(window.lucide) lucide.createIcons(); }
      function close(){ modal.classList.add('hidden'); document.body.classList.remove('no-scroll'); }
      closeBtn?.addEventListener('click', close);
      modal.addEventListener('click', e=>{ if(e.target===modal) close(); });
      dmBtn?.addEventListener('click', ()=>{ window.location.href='Dm.html'; });
      document.addEventListener('click', e=>{
        const btn=e.target.closest('.ad-details-btn');
        if(!btn) return;
        title.textContent=btn.dataset.adTitle||'Advertisement';
        tagline.textContent=btn.dataset.adTagline||'';
        body.textContent=btn.dataset.adBody||'';
        img.src=btn.dataset.adImage||'';
        loc.textContent=btn.dataset.adLocation||'';
        contact.textContent=btn.dataset.adContact||'';
        open();
      });
    })();
  </script>
</body>
</html>
